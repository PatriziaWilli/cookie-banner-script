!function(){const e=document.currentScript,t=e.dataset.siteId,n=e.dataset.token,o="cookie_consent";if(!t||!n)return;let c=[],i=[];function a(){const e=document.cookie.match(new RegExp("(^| )"+o+"=([^;]+)"));if(e)try{const t=JSON.parse(decodeURIComponent(e[2]));return console.log("Leggo cookie_consent:",t),t}catch{return console.warn("Errore parsing cookie_consent"),null}return console.log("cookie_consent non trovato"),null}function s(e){console.log("Scrivo cookie_consent con:",e);const t=encodeURIComponent(JSON.stringify(e)),n=new Date;n.setFullYear(n.getFullYear()+1),document.cookie=`${o}=${t};expires=${n.toUTCString()};path=/;SameSite=Lax`}function r(e){c.forEach((t=>{var n;e.includes(t)?(n=t,document.querySelectorAll(`script[data-cookie-placeholder="${n}"]`).forEach((e=>{if("true"===e.dataset.loaded)return;const t=document.createElement("script");t.type="text/javascript",e.src&&(t.src=e.src),e.async&&(t.async=!0),e.defer&&(t.defer=!0),e.textContent&&(t.textContent=e.textContent),e.dataset.loaded="true",e.parentNode.replaceChild(t,e)}))):"essential"!==t&&function(e){document.querySelectorAll(`script[data-cookie-category="${e}"]`).forEach((e=>e.parentNode.removeChild(e)))}(t)}))}function l(){let e=document.getElementById("cookie-settings-button");e?e.style.display="block":(e=document.createElement("button"),e.id="cookie-settings-button",e.textContent="Modifica preferenze cookie",Object.assign(e.style,{position:"fixed",bottom:"15px",right:"15px",zIndex:"10000",background:"#222",color:"white",border:"none",padding:"10px 15px",borderRadius:"5px",cursor:"pointer",fontFamily:"Arial, sans-serif",fontSize:"14px",boxShadow:"0 2px 6px rgba(0,0,0,0.3)"}),e.onclick=d,document.body.appendChild(e))}function d(){const e=document.getElementById("cookie-banner");e&&e.remove();const t=document.getElementById("cookie-settings-button");t&&(t.style.display="none");const n=a()||["essential"],o=document.createElement("div");o.id="cookie-banner",Object.assign(o.style,{position:"fixed",bottom:"0",left:"0",right:"0",background:"#222",color:"white",padding:"15px",fontFamily:"Arial, sans-serif",zIndex:"9999"});const i=document.createElement("div");i.innerText="Seleziona le categorie di cookie che accetti:",i.style.marginBottom="10px";const d=document.createElement("form");c.forEach((e=>{const t=document.createElement("label");t.style.display="block",t.style.marginBottom="5px";const o=document.createElement("input");o.type="checkbox",o.name="cookie-category",o.value=e,o.disabled="essential"===e,o.checked="essential"===e||n.includes(e),t.append(o,document.createTextNode(" "+e)),d.append(t)}));const u=document.createElement("button");u.type="submit",u.innerText="Salva preferenze",u.style.marginTop="10px",d.append(u),o.append(i,d),document.body.appendChild(o),d.onsubmit=e=>{e.preventDefault();const t=Array.from(d.elements["cookie-category"]).filter((e=>e.checked)).map((e=>e.value));t.includes("essential")||t.unshift("essential"),s(t),r(t),o.remove(),l()}}fetch(`https://brave-connection-f862697dcf.strapiapp.com/api/clients/${t}?populate=cookies`).then((e=>e.json())).then((e=>{const o=e.data;if(!o)return void console.warn("Client non trovato nella risposta");if(o.token!==n)return void console.warn("Client non autorizzato o token errato.");const u=o.cookies||[];console.log("âœ… Banner attivato per:",t,"ðŸ“¦ Cookies:",u),c=[...new Set(u.map((e=>e.category)))],c.includes("essential")||c.unshift("essential");const p=a();Array.isArray(p)&&p.length>0?(r(p),l()):function(e){i=e,c=[...new Set(e.map((e=>e.category)))],c.includes("essential")||c.unshift("essential");const t=document.getElementById("cookie-settings-button");t&&(t.style.display="none");const n=document.getElementById("cookie-banner");n&&n.remove();const o=document.createElement("div");o.id="cookie-banner",Object.assign(o.style,{position:"fixed",bottom:"0",left:"0",right:"0",background:"#222",color:"white",padding:"15px",fontFamily:"Arial, sans-serif",zIndex:"9999",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap"});const a=document.createElement("div");a.innerText="Questo sito usa cookie. Gestisci le tue preferenze.";const u=document.createElement("div"),p=document.createElement("button");p.innerText="Accetta tutti",p.style.marginRight="10px",p.onclick=()=>{s(c),r(c),o.remove(),l()};const m=document.createElement("button");m.innerText="Rifiuta non essenziali",m.style.marginRight="10px",m.onclick=()=>{s(["essential"]),r(["essential"]),o.remove(),l()};const f=document.createElement("button");f.innerText="Personalizza",f.onclick=d,u.append(p,m,f),o.append(a,u),document.body.appendChild(o)}(u)})).catch((e=>console.error("Errore di fetch:",e)))}();